

<%content_for :page_title do
    if @order.line_items.empty?
        t('your_cart_is_empty')
    else
        t("items_in_your_cart")
    end
end %>

<div class="checkout-content" id="cart">

  <% unless @order.line_items.empty? %>
      <%= form_for(@order, :url => update_cart_path, :html=>{:id=>'updatecart'}) do |order_form| %>
          <%= render :partial => 'form', :locals => {:order_form => order_form} %>
      <% end %>
  <% end %>


  <div id="subtotal" class="clearfix">
    <% unless @order.line_items.empty? %>
        <div id="spin_here">&nbsp</div>
        <div id="amount">
          <h3><%= "#{t("subtotal")}: #{order_price(@order)}" %></h3>
        </div>
    <%end%>

  </div>

</div>



<%content_for :next_button do %>
    <%unless @order.line_items.empty? %>
        <a href="/store/checkout" class="next-button"><span><%= "#{t('continue')}"%></span></a>
    <%end%>
<%end%>

<%content_for :back_button do %>
  <a href="/" class="back-button"><span><%= "#{t('continue_shopping')}"%></span></a>
<%end%>


<%content_for :page_javascript  do%>
<script type="text/javascript">
 $(document).ready( function(){
     $('form#updatecart a.delete').click( function(e){
        e.preventDefault();
        if( confirm('<%=t('are_you_sure_delete')%>') ){
            $(this).parents('tr').find('input.item_quantity').val(0);
        }
     });

     $('.item_quantity').change(function( ){
         if( $(this).val() >= 1 ){
             //console.debug('recalculate for '+$(this).val());
             new Spinner({ lines: 8,
                 length: 4,
                 width: 3,
                 radius: 3,
                 color: '#666666',
                 speed: 1,
                 trail: 50, // Afterglow percentage
                 shadow: false
             }).spin( document.getElementById('spin_here'));
             $('form#updatecart').submit();
         }
     });

 });
</script>
<%end%>