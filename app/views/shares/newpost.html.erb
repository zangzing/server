<div class="album-header">
  <h3>Post Your Album</h3>
  <h4>Share your album with all your friends on Facebook or Twitter!</h4>
</div>

<div id="scroll-body">
  <%form_for @share, :url => create_album_share_path(@album)  do |f| %>
    <div class="offset"><%= f.error_messages %></div>
    
    <div id="form-container" class="clearfix">
      <dl id="social-form" class="clearfix">
        <dt id="network"><input type="checkbox" name="post_share[facebook]" /> <img src="/images/icon-facebook-16.png" /></dt>
        <dd>Facebook</dd>
        <dt><input type="checkbox" name="post_share[twitter]" /> <img src="/images/icon-twitter-16.png" /></dt>
        <dd>Twitter</dd>
        <div class="clear-fix"></div>
        <dt>Post</dt>
        <dd id="post-text"><textarea rows="3" name="post_share[message]" id="post_share_message"></textarea></dd>    
      </dl>  
      
      <input type="image" src="/images/btn-post.png" name="submit" id="social-submit" />
    </div>
  <% end %>
</div>

<div class="offset">

<h3 class="album">New Post Share</h3>
<%form_for @share, :url => create_album_share_path(@album)  do |f| %>
    <%= f.error_messages %>

    <table>
      <tr>
        <td>Twitter:<%= f.check_box(  'twitter',{ :id => "twitter_box", :onclick => "call_new_twitter_session();"}) %></td>
        <td>Facebook:<%= f.check_box( 'facebook',{:authorized => "yes",:id => "facebook_box", :onclick => "call_new_facebook_session();"}) %></td>
      </tr>
      <tr>
        <td>Post: <%= f.text_area( :message, :cols=>40,  :rows=>10) %></td><td><%= f.submit "Post"%></td>
      </tr>
    </table>
<% end %>

<script type="text/javascript">
function call_new_facebook_session(){
    
    if($("#facebook_box").is(':checked') && !$("#facebook_box").attr('authorized')){
        oauthmanager.login( '<%=new_facebook_session_url%>', facebook_login_success);
    }
}
function facebook_login_success(){
   $("#facebook_box").attr('authorized', 'yes')
}
function call_new_twitter_session(){
    if($("#twitter_box").is(':checked') && !$("#twitter_box").attr('authorized')){
       alert("Checking with twitter ");
        // oauthmanager.login( '<%=new_twitter_session_url%>', twitter_login_success)
    }
}
function twitter_login_success(){
    $("#twitter_box").attr('authorized', 'yes')
}
</script>
</div>
